(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{450:function(t,a,s){"use strict";s.r(a);var r=s(56),i=Object(r.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"前端交互相关"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前端交互相关"}},[t._v("#")]),t._v(" 前端交互相关")]),t._v(" "),s("h2",{attrs:{id:"键盘弹起-页面上推"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#键盘弹起-页面上推"}},[t._v("#")]),t._v(" 键盘弹起，页面上推")]),t._v(" "),s("p",[t._v("如下图，键盘弹起或者选择图片面板出现，需要将页面整体上推。")]),t._v(" "),s("p",[t._v("uview组件库的"),s("a",{attrs:{href:"https://www.uviewui.com/components/input.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("input组件"),s("OutboundLink")],1),t._v(" 有一个 "),s("code",[t._v("adjustPosition")]),t._v(" 属性用于设置键盘弹起时自动上推页面。但是它会导致顶部导航栏也被推上去（我们是自定义导航栏，uni 默认的导航栏不知道会不会被推上去）。")]),t._v(" "),s("p",[t._v("解决方法：监听键盘弹起事件，动态计算键盘高度，给容器设置对应高度的 padding，让键盘浮在这块空白区域上。")]),t._v(" "),s("img",{staticStyle:{transform:"scale(0.8)"},attrs:{src:t.$withBase("/imgs/im/chat-panel-open.jpg")}}),t._v(" "),s("h2",{attrs:{id:"长按消息的-tooltip"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#长按消息的-tooltip"}},[t._v("#")]),t._v(" 长按消息的 tooltip")]),t._v(" "),s("p",[t._v("如下图：tooltip 出现的位置与元素的位置和尺寸有关，还与消息类型有关(引用消息的tooltip出现在回复的内容区域上而非整条消息上)。没有找到合适的现成组件。")]),t._v(" "),s("p",[t._v("解决方法: 获取目标元素（长按元素或长按元素的子元素）的尺寸和位置信息，动态计算 tooltip 的位置和 tooltip 小尖尖的位置。\n"),s("img",{staticStyle:{transform:"scale(0.9)"},attrs:{src:t.$withBase("/imgs/im/tooltip.png")}})]),t._v(" "),s("h2",{attrs:{id:"页面自动滚动到底部"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#页面自动滚动到底部"}},[t._v("#")]),t._v(" 页面自动滚动到底部")]),t._v(" "),s("p",[t._v("以下场景需要自动将页面滚动到底部：")]),t._v(" "),s("ol",[s("li",[t._v("页面首次进来")]),t._v(" "),s("li",[t._v("键盘弹起或选择图片面板弹起")]),t._v(" "),s("li",[t._v("点击 tooltip 上的回复（其实就是2）")]),t._v(" "),s("li",[t._v("别人给我发消息，如果页面滚动高度不足一屏，需要自动将页面滚动到底部（页面滚动高度大于一屏，认为用户是在查看历史消息，不需要滚动到底）")]),t._v(" "),s("li",[t._v("自己给自己发消息，无论页面滚动高度是否大于一屏，都需要将页面滚动到底部")])]),t._v(" "),s("h2",{attrs:{id:"丝滑的向上滚动加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#丝滑的向上滚动加载"}},[t._v("#")]),t._v(" 丝滑的向上滚动加载")]),t._v(" "),s("p",[t._v("如下图：滚动到顶的时候，loading 出现，往列表前面 "),s("code",[t._v("unshift")]),t._v(" n 条数据，由于页面有保持原有滚动高度的特性，所以会自动滚动到顶部，但是我们期望的是页面停留在用户之前的阅读位置。")]),t._v(" "),s("p",[t._v("并不好的解决方法：数据 "),s("code",[t._v("unshift")]),t._v(" 完，再让页面滚回用户之前的阅读位置。效果是有明显的页面抖动感。")]),t._v(" "),s("p",[t._v("暂时没有好的解决方案。")]),t._v(" "),s("img",{staticStyle:{transform:"scale(0.8)"},attrs:{src:t.$withBase("/imgs/im/loadingmore.jpg")}}),t._v(" "),s("h2",{attrs:{id:"图片的展示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片的展示"}},[t._v("#")]),t._v(" 图片的展示")]),t._v(" "),s("p",[t._v("方便处理，直接固定了图片宽度，右侧好看的为微信效果。")]),t._v(" "),s("img",{staticStyle:{transform:"scale(0.8)"},attrs:{src:t.$withBase("/imgs/im/picture-display.png")}}),t._v(" "),s("h2",{attrs:{id:"图片发送是无序的"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片发送是无序的"}},[t._v("#")]),t._v(" 图片发送是无序的")]),t._v(" "),s("p",[t._v("uni 的图片选择api "),s("a",{attrs:{href:"https://uniapp.dcloud.net.cn/api/media/image.html#chooseimage",target:"_blank",rel:"noopener noreferrer"}},[t._v("uni.chooseImage"),s("OutboundLink")],1),t._v("返回的已选图片列表本身就是无序的。")]),t._v(" "),s("h2",{attrs:{id:"消息发送按钮"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消息发送按钮"}},[t._v("#")]),t._v(" 消息发送按钮")]),t._v(" "),s("p",[t._v("没有做机型判断，消息发送按钮恒展示，所以在 ios 会看到两个发送按钮。")]),t._v(" "),s("p",[t._v("冷知识：安卓右下角是换行键，所以安卓发消息的时候可以换行，但是ios不行。")]),t._v(" "),s("img",{staticStyle:{transform:"scale(0.9)"},attrs:{src:t.$withBase("/imgs/im/send-btn.jpg")}}),t._v(" "),s("h2",{attrs:{id:"长按部分选中"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#长按部分选中"}},[t._v("#")]),t._v(" 长按部分选中")]),t._v(" "),s("p",[t._v("没做，uni 没有相关的 api。")])])}),[],!1,null,null,null);a.default=i.exports}}]);